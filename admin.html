<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | Alabat Tourism</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }

        body {
            background: linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), 
                        url('background.jpg') no-repeat center center fixed; 
            background-size: cover; color: white; min-height: 100vh;
        }

        /* --- LOGIN OVERLAY --- */
        #login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); backdrop-filter: blur(25px);
            display: flex; justify-content: center; align-items: center; z-index: 9999;
        }
        .login-box {
            background: rgba(255,255,255,0.05); padding: 50px; border-radius: 40px;
            border: 1px solid rgba(255,255,255,0.1); width: 100%; max-width: 400px; text-align: center;
        }
        .login-box input {
            width: 100%; padding: 15px; margin-top: 15px; border-radius: 15px;
            border: 1px solid rgba(255,255,255,0.1); background: rgba(0,0,0,0.4);
            color: white; outline: none; font-size: 16px;
        }
        .login-box button {
            width: 100%; padding: 15px; margin-top: 25px; border-radius: 50px;
            border: none; background: #00AEEF; color: white; font-weight: 900;
            cursor: pointer; text-transform: uppercase; letter-spacing: 1px;
        }

        /* --- DASHBOARD LAYOUT --- */
        #admin-content { display: none; padding: 40px 20px; }
        
        .header-area { 
            display: flex; justify-content: space-between; align-items: center; 
            max-width: 1300px; margin: 0 auto 30px; 
        }
        .nav-logo { height: 50px; }
        .logout-btn { 
            color: #ff4757; font-weight: 900; font-size: 12px; cursor: pointer; 
            padding: 10px 20px; border-radius: 50px; border: 1px solid #ff4757;
            text-transform: uppercase;
        }

        .dashboard-grid { 
            display: grid; grid-template-columns: 1fr 400px; gap: 30px; 
            max-width: 1300px; margin: 0 auto; 
        }

        .glass-panel {
            background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(20px);
            border-radius: 35px; padding: 35px; border: 1px solid rgba(255,255,255,0.1);
        }

        /* --- METRICS --- */
        .revenue-card {
            background: linear-gradient(135deg, #00AEEF, #007bb0);
            padding: 30px; border-radius: 30px; margin-bottom: 30px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 15px 30px rgba(0, 174, 239, 0.3);
        }
        .revenue-card h3 { font-size: 12px; text-transform: uppercase; letter-spacing: 2px; color: rgba(255,255,255,0.8); }
        .revenue-card p { font-size: 36px; font-weight: 900; }

        /* --- TABLES & TABS --- */
        .tabs { display: flex; gap: 10px; margin-bottom: 25px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px; }
        .tab-btn { 
            background: none; border: none; color: white; padding: 10px 20px; 
            border-radius: 12px; cursor: pointer; font-size: 12px; font-weight: 800; opacity: 0.5;
            text-transform: uppercase; transition: 0.3s;
        }
        .tab-btn.active { opacity: 1; background: rgba(0, 174, 239, 0.15); color: #00AEEF; }

        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; font-size: 11px; text-transform: uppercase; opacity: 0.4; padding: 15px; }
        td { padding: 20px 15px; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 14px; }

        .badge { 
            background: #00AEEF; color: black; padding: 4px 8px; 
            border-radius: 6px; font-weight: 900; font-size: 11px; 
        }

        /* --- BUTTONS --- */
        .action-btn { 
            padding: 10px 15px; border-radius: 12px; border: none; 
            font-weight: 800; font-size: 10px; cursor: pointer; text-transform: uppercase; 
        }
        .btn-green { background: #4caf50; color: white; }
        .btn-yellow { background: #ffbc00; color: black; }
        .btn-red { background: none; border: 1px solid #ff4757; color: #ff4757; }

        /* --- INVENTORY --- */
        .inventory-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px; background: rgba(255,255,255,0.03); border-radius: 20px; margin-bottom: 10px;
        }
        .toggle-group { display: flex; gap: 5px; background: #000; padding: 5px; border-radius: 12px; }
        .toggle-btn { 
            padding: 6px 12px; border-radius: 8px; border: none; font-size: 9px; 
            font-weight: 900; cursor: pointer; color: rgba(255,255,255,0.4); background: transparent;
        }
        .toggle-btn.active-on { background: #4caf50; color: white; }
        .toggle-btn.active-off { background: #ff4757; color: white; }

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); display: none; justify-content: center; align-items: center; z-index: 5000;
        }
        .modal-card { background: #111; padding: 40px; border-radius: 35px; width: 450px; border: 1px solid #333; }
        .modal-card input { width: 100%; padding: 15px; margin-bottom: 15px; border-radius: 12px; background: #222; border: 1px solid #444; color: white; }
    </style>
</head>
<body>

    <div id="login-overlay">
        <div class="login-box">
            <img src="AlabatLogo.png" alt="Logo" style="height: 60px; margin-bottom: 25px;">
            <h2 style="font-weight: 900; margin-bottom: 10px;">STAFF LOGIN</h2>
            <input type="text" id="username" placeholder="Employee ID">
            <input type="password" id="password" placeholder="Password">
            <button onclick="checkLogin()">Enter Dashboard</button>
            <p id="error-msg" style="color: #ff4757; margin-top: 15px; font-size: 12px; display: none;">Invalid Staff Credentials</p>
        </div>
    </div>

    <div id="admin-content">
        <header class="header-area">
            <img src="AlabatLogo.png" class="nav-logo">
            <div style="text-align: right;">
                <p style="font-size: 10px; opacity: 0.5; font-weight: 900;">ADMINISTRATOR SESSION</p>
                <a class="logout-btn" onclick="logout()">Sign Out</a>
            </div>
        </header>

        <div class="dashboard-grid">
            <div class="main-panel">
                <div class="revenue-card">
                    <div>
                        <h3>Total Earnings (Completed Orders)</h3>
                        <p id="total-revenue">₱0.00</p>
                    </div>
                    <button class="action-btn" style="background: rgba(0,0,0,0.3); color: white;" onclick="resetDay()">Clear History</button>
                </div>

                <div class="glass-panel">
                    <div class="tabs">
                        <button class="tab-btn active" onclick="switchTab('queue', this)">Active Queue</button>
                        <button class="tab-btn" onclick="switchTab('completed', this)">Completed</button>
                        <button class="tab-btn" onclick="switchTab('cancelled', this)">Cancelled</button>
                    </div>
                    
                    <table id="order-table">
                        <thead>
                            <tr>
                                <th>Order</th>
                                <th>Customer</th>
                                <th>Payment</th>
                                <th>Summary</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="table-body"></tbody>
                    </table>
                </div>
            </div>

            <div class="side-panel">
                <div class="glass-panel">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <h2 style="font-size: 16px; font-weight: 900;">INVENTORY</h2>
                        <button class="badge" style="cursor: pointer; border: none;" onclick="showAddModal()">+ ADD</button>
                    </div>
                    <div id="inventory-list"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="productModal">
        <div class="modal-card">
            <h2 style="margin-bottom: 25px;">Add New Product</h2>
            <input type="text" id="pName" placeholder="Product Name">
            <input type="number" id="pPrice" placeholder="Price (Numeric Only)">
            <input type="text" id="pImg" placeholder="Image Filename (e.g. honey.jpg)">
            <input type="text" id="pContent" placeholder="Weight/Size (e.g. 500ml)">
            <div style="display: flex; gap: 10px;">
                <button class="action-btn btn-red" style="flex: 1;" onclick="closeModal()">Cancel</button>
                <button class="action-btn btn-green" style="flex: 2; background: #00AEEF;" onclick="saveProduct()">Save Product</button>
            </div>
        </div>
    </div>

    <script>
        // --- AUTHENTICATION ---
        function checkLogin() {
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;
            if(u === "admin" && p === "alabat2026") {
                localStorage.setItem('alabat_admin', 'true');
                initDashboard();
            } else {
                document.getElementById('error-msg').style.display = 'block';
            }
        }

        function initDashboard() {
            document.getElementById('login-overlay').style.display = 'none';
            document.getElementById('admin-content').style.display = 'block';
            renderOrders();
            renderInventory();
        }

        function logout() {
            localStorage.removeItem('alabat_admin');
            location.reload();
        }

        // --- ORDER MANAGEMENT ---
        let currentTab = 'queue';

        function switchTab(tab, btn) {
            currentTab = tab;
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            renderOrders();
        }

        function renderOrders() {
            const orders = JSON.parse(localStorage.getItem('alabat_orders')) || [];
            const body = document.getElementById('table-body');
            body.innerHTML = "";

            const filtered = orders.filter(o => {
                const s = o.status || 'pending';
                if(currentTab === 'queue') return s === 'pending' || s === 'processing';
                return s === currentTab;
            }).reverse();

            filtered.forEach(o => {
                const items = o.items.map(i => `${i.name} (x${i.quantity})`).join('<br>');
                let actions = "";

                if(currentTab === 'queue') {
                    if(o.status === 'pending') {
                        actions = `<button class="action-btn btn-yellow" onclick="updateStatus('${o.orderID}', 'processing')">Process</button>`;
                    } else {
                        actions = `<button class="action-btn btn-green" onclick="updateStatus('${o.orderID}', 'completed')">Finish</button>`;
                    }
                    actions += `<button class="action-btn btn-red" style="margin-left:5px" onclick="updateStatus('${o.orderID}', 'cancelled')">✕</button>`;
                } else {
                    actions = `<span style="font-size:9px; opacity:0.5">${o.timestamp}</span>`;
                }

                body.innerHTML += `
                    <tr>
                        <td><span class="badge">#${o.orderID}</span></td>
                        <td><b>${o.recipient}</b></td>
                        <td><span style="font-size:11px">${o.paymentMode}</span></td>
                        <td style="font-size:12px; opacity:0.8">${items}</td>
                        <td>${actions}</td>
                    </tr>
                `;
            });
            updateRevenue();
        }

        function updateStatus(id, newStatus) {
            let orders = JSON.parse(localStorage.getItem('alabat_orders')) || [];
            const index = orders.findIndex(o => o.orderID == id);
            if(index !== -1) {
                orders[index].status = newStatus;
                localStorage.setItem('alabat_orders', JSON.stringify(orders));
                renderOrders();
            }
        }

        function updateRevenue() {
            const orders = JSON.parse(localStorage.getItem('alabat_orders')) || [];
            const total = orders.filter(o => o.status === 'completed').reduce((sum, o) => {
                return sum + parseFloat(o.total.replace(/[₱,]/g, ''));
            }, 0);
            document.getElementById('total-revenue').innerText = `₱${total.toLocaleString(undefined, {minimumFractionDigits: 2})}`;
        }

        function resetDay() {
            if(confirm("Are you sure? This clears all completed and cancelled logs.")) {
                let orders = JSON.parse(localStorage.getItem('alabat_orders')) || [];
                const active = orders.filter(o => o.status === 'pending' || o.status === 'processing');
                localStorage.setItem('alabat_orders', JSON.stringify(active));
                renderOrders();
            }
        }

        // --- INVENTORY MANAGEMENT ---
        function renderInventory() {
            const inv = JSON.parse(localStorage.getItem('alabat_inventory')) || [];
            const container = document.getElementById('inventory-list');
            container.innerHTML = "";

            inv.forEach((item, i) => {
                const isAvail = item.available !== false;
                container.innerHTML += `
                    <div class="inventory-item">
                        <div>
                            <p style="font-weight:900; font-size:14px;">${item.name}</p>
                            <p style="font-size:11px; color:#00AEEF;">${item.price}</p>
                        </div>
                        <div class="toggle-group">
                            <button class="toggle-btn ${isAvail ? 'active-on' : ''}" onclick="toggleAvail(${i}, true)">ON</button>
                            <button class="toggle-btn ${!isAvail ? 'active-off' : ''}" onclick="toggleAvail(${i}, false)">OFF</button>
                        </div>
                    </div>
                `;
            });
        }

        function toggleAvail(index, state) {
            let inv = JSON.parse(localStorage.getItem('alabat_inventory'));
            inv[index].available = state;
            localStorage.setItem('alabat_inventory', JSON.stringify(inv));
            renderInventory();
        }

        function showAddModal() { document.getElementById('productModal').style.display = 'flex'; }
        function closeModal() { document.getElementById('productModal').style.display = 'none'; }

        function saveProduct() {
            const name = document.getElementById('pName').value;
            const price = document.getElementById('pPrice').value;
            if(!name || !price) return alert("Fill in required fields");

            let inv = JSON.parse(localStorage.getItem('alabat_inventory')) || [];
            inv.push({
                name: name,
                price: `₱${parseFloat(price).toFixed(2)}`,
                img: document.getElementById('pImg').value || 'default.jpg',
                content: document.getElementById('pContent').value || 'N/A',
                available: true
            });
            localStorage.setItem('alabat_inventory', JSON.stringify(inv));
            renderInventory();
            closeModal();
        }

        // Keep logged in on refresh
        window.onload = () => {
            if(localStorage.getItem('alabat_admin') === 'true') initDashboard();
        };
    </script>
</body>
</html>

